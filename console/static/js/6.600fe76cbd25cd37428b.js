webpackJsonp([6],{"3GKm":function(t,e,s){var o=s("c9Kt");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);s("rjj0")("041bd27a",o,!0)},"8YMv":function(t,e,s){var o=s("cyC8");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);s("rjj0")("7e7d6c5c",o,!0)},K85C:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o={name:"editArticle",components:{ArticleDetail:s("oGlg").a}},r={render:function(){var t=this.$createElement;return(this._self._c||t)("article-detail",{attrs:{"is-edit":!0}})},staticRenderFns:[]},a=s("VU/8")(o,r,!1,null,null,null);e.default=a.exports},c9Kt:function(t,e,s){(t.exports=s("FZ+f")(!1)).push([t.i,'\n.post-container[data-v-4501bd42] {\n  position: relative;\n}\n.post-container .post-main-container[data-v-4501bd42] {\n    padding: 10px 10px 10px 10px;\n}\n.post-container .post-main-container .post-content-container #post-editor[data-v-4501bd42] {\n      margin: auto;\n      width: 100%;\n      height: 650px;\n}\n.post-container .post-main-container .post-content-container #post-description[data-v-4501bd42] {\n      margin: 20px 0;\n}\n.post-container .word-counter[data-v-4501bd42] {\n    width: 40px;\n    position: absolute;\n    right: -10px;\n    top: 0px;\n}\n.post-container .clearfix[data-v-4501bd42]:before,\n  .post-container .clearfix[data-v-4501bd42]:after {\n    display: table;\n    content: "";\n}\n.post-container .clearfix[data-v-4501bd42]:after {\n    clear: both;\n}\n.post-container .cover-picture-selected[data-v-4501bd42] {\n    width: 200px;\n    height: 200px;\n    border: 2px dashed #A8A8A8;\n    color: #A8A8A8;\n    border-radius: 4px;\n    cursor: pointer;\n    margin-top: 10px;\n}\n.post-container .cover-picture-selected[data-v-4501bd42]:hover {\n    border: 2px dashed #409EFF;\n    color: #409EFF;\n}\n.post-container .image-slot[data-v-4501bd42], .post-container .image-error[data-v-4501bd42] {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-pack: center;\n        -ms-flex-pack: center;\n            justify-content: center;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n    width: 100%;\n    height: 100%;\n    background: #ffffff;\n    font-size: 30px;\n}\n.post-container .cover-picture-selected:hover .image-slot[data-v-4501bd42], .post-container .cover-picture-selected:hover .image-error[data-v-4501bd42] {\n    background: #daecff;\n}\n.picture-list-card[data-v-4501bd42] {\n  margin-bottom: 10px;\n}\n.picture-list-card .picture-list-image[data-v-4501bd42] {\n    width: 100%;\n    height: 150px;\n    cursor: pointer;\n    border-radius: 4px;\n}\n.picture-list-card .picture-list-image[data-v-4501bd42]:hover {\n    -webkit-box-shadow: 0 2px 4px rgba(0, 0, 0, 0.12), 0 0 6px rgba(0, 0, 0, 0.04);\n            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.12), 0 0 6px rgba(0, 0, 0, 0.04);\n}\n',""])},cyC8:function(t,e,s){(t.exports=s("FZ+f")(!1)).push([t.i,"\n.el-drawer__body {\n  padding: 0 20px 20px 20px;\n  overflow: auto;\n}\n.el-tree-node__label{\n  margin-left: 5px;\n}\n",""])},oGlg:function(t,e,s){"use strict";var o=s("woOf"),r=s.n(o),a=s("OS1Z"),i=s("h3d2"),c=s("0QkR"),n=s("viA7"),l=s("oCAU"),p=(s("pw1w"),{id:void 0,status:"draft",title:"",content:"",content_html:"",description:"",comment_status:1,cover_picture:"",posted_time:"",if_top:0,category:[],tag:[],subject:[]}),d={name:"articleDetail",components:{mavonEditor:a.mavonEditor},props:{isEdit:{type:Boolean,default:!1}},data:function(){return{postForm:r()({},p),defaultStatus:"draft",defaultExpandAllCategory:!0,categoryTab:"allCategory",categoryData:[],categoryProps:{id:"item_id",children:"children",label:"name"},defaultCheckedCategory:[1],filterText:"",subjectData:[],subjectProps:{id:"id",children:"children",label:"name"},defaultExpandAllSubject:!0,defaultCheckedSubject:[],filterSubjectText:"",tagOptions:[],defaultSelectTags:[],activeValue:1,inactiveValue:0,coverPictureDrawer:!1,coverPictureDirection:"rtl",coverPictureListQuery:{page:1,limit:24},coverPictureList:null,coverPictureListTotal:0,coverPictureListLoading:!1}},watch:{filterText:function(t){this.$refs.categoryTree.filter(t)},filterSubjectText:function(t){this.$refs.subjectTree.filter(t)}},computed:{contentShortLength:function(){return void 0!==this.postForm.description?this.postForm.description.length:0}},created:function(){if(this.setTitle(),this.initTaxonomy(),this.isEdit){var t=this.$route.params.id;this.getArticleInfo(t)}else this.postForm=r()({},p)},methods:{setTitle:function(){document.title=this.$t("route."+this.$route.meta.title)+" | Puti"},initTaxonomy:function(){var t=this;Object(i.c)({type:"category"}).then(function(e){t.categoryData=e.data}),Object(i.c)({type:"tag"}).then(function(e){t.tagOptions=e.data}),Object(c.c)().then(function(e){t.subjectData=e.data})},getArticleInfo:function(t){var e=this;Object(n.c)(t).then(function(t){var s=t.data;e.postForm.id=s.id,e.postForm.status=s.status,e.postForm.title=s.title,e.postForm.content=s.content_markdown,e.postForm.description=s.meta_date.description?s.meta_date.description:"",e.postForm.comment_status=s.comment_status,e.postForm.cover_picture=s.cover_picture,e.postForm.posted_time=s.post_date,e.postForm.if_top=s.if_top,e.postForm.category=s.category,e.postForm.tag=s.tag,e.postForm.subject=s.subject,e.$refs.categoryTree.setCheckedKeys(e.postForm.category),e.$refs.subjectTree.setCheckedKeys(e.postForm.subject),e.defaultStatus=s.status})},filterNode:function(t,e){return!t||-1!==e.name.indexOf(t)},getCategoryCheckedKeys:function(){return this.$refs.categoryTree.getCheckedKeys()},getSubjectCheckedKeys:function(){return this.$refs.subjectTree.getCheckedKeys()},subjectCheckChange:function(t,e){if(0!==t.parent_id)if(!0===e)this.$refs.subjectTree.setChecked(t.parent_id,!0);else{for(var s=this.$refs.subjectTree.getNode(t.parent_id),o=!1,r=0,a=s.childNodes.length;r<a;r++)if(!0===s.childNodes[r].checked){o=!0;break}o||this.$refs.subjectTree.setChecked(t.parent_id,!1)}if(null!=t.children&&!1===e)for(var i=0,c=t.children.length;i<c;i++){var n=this.$refs.subjectTree.getNode(t.children[i].id);!0===n.checked&&this.$refs.subjectTree.setChecked(n.data.id,!1)}},getHtmlContent:function(t,e){this.postForm.content_html=e},submitForm:function(){this.postForm.status="publish",this.postForm.category=this.getCategoryCheckedKeys(),this.postForm.subject=this.getSubjectCheckedKeys(),0===this.postForm.category.length&&(this.postForm.category=this.defaultCheckedCategory),0===this.postForm.subject.length&&(this.postForm.subject=this.defaultCheckedSubject),void 0===this.postForm.id?this.createArticle():this.updateArticle()},draftForm:function(){this.postForm.status="draft",this.postForm.category=this.getCategoryCheckedKeys(),this.postForm.subject=this.getSubjectCheckedKeys(),0===this.postForm.category.length&&(this.postForm.category=this.defaultCheckedCategory),0===this.postForm.subject.length&&(this.postForm.subject=this.defaultCheckedSubject),void 0===this.postForm.id?this.createArticle():this.updateArticle()},createArticle:function(){var t=this,e=this.$store.getters.token;Object(n.a)(this.postForm,e).then(function(e){t.$message({message:t.$t("common.operationSucceeded"),type:"success",duration:2e3}),e.data.id&&t.$router.push({path:"/article/edit/"+e.data.id})}).catch(function(e){t.postForm.status=t.defaultStatus})},updateArticle:function(){var t=this;Object(n.e)(this.postForm).then(function(e){t.$message({message:t.$t("common.operationSucceeded"),type:"success",duration:2e3}),t.getArticleInfo(t.$route.params.id)}).catch(function(e){t.postForm.status=t.defaultStatus})},getCoverPicture:function(){var t=this;this.coverPictureListLoading=!0,Object(l.b)(this.coverPictureListQuery).then(function(e){t.coverPictureList=e.data.mediaList,t.coverPictureListTotal=e.data.totalCount}),this.coverPictureListLoading=!1},cleanPictureList:function(){this.coverPictureList=null,this.coverPictureListTotal=0,this.coverPictureListQuery.page=1,this.coverPictureListLoading=!1},handlePageChange:function(t){this.coverPictureListQuery.page=t,this.getCoverPicture()},chooseCoverPicture:function(t){this.postForm.cover_picture=t,this.$refs.coverPictureDrawer.closeDrawer()}}},u={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app-container-grey"},[s("div",{staticClass:"post-container"},[s("el-form",{ref:"postForm",staticClass:"form-container",attrs:{model:t.postForm,"label-position":"left"}},[s("div",{staticClass:"post-main-container"},[s("el-row",{attrs:{gutter:20}},[s("el-col",{staticClass:"post-content-container",attrs:{xs:24,sm:24,md:18,lg:19,xl:19}},[s("el-form-item",{attrs:{prop:"title"}},[s("el-input",{staticClass:"post-title-container",attrs:{placeholder:t.$t("post.pleaseInputArticleTitle")},model:{value:t.postForm.title,callback:function(e){t.$set(t.postForm,"title",e)},expression:"postForm.title"}},[s("template",{slot:"prepend"},[t._v(t._s(t.$t("post.postTitle")))])],2)],1),t._v(" "),s("div",{attrs:{id:"post-editor"}},[s("mavon-editor",{staticStyle:{height:"100%"},attrs:{boxShadow:!1},on:{change:t.getHtmlContent},model:{value:t.postForm.content,callback:function(e){t.$set(t.postForm,"content",e)},expression:"postForm.content"}})],1),t._v(" "),s("el-form-item",{attrs:{id:"post-description","label-width":"80px",label:t.$t("post.postDescription")}},[s("el-input",{staticClass:"article-textarea",attrs:{type:"textarea",rows:1,autosize:"",placeholder:t.$t("post.pleaseInputPostDescription")},model:{value:t.postForm.description,callback:function(e){t.$set(t.postForm,"description",e)},expression:"postForm.description"}}),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:t.contentShortLength,expression:"contentShortLength"}],staticClass:"word-counter"},[t._v(t._s(t.contentShortLength)+" "+t._s(t.$t("post.postDescriptionWords")))])],1),t._v(" "),s("el-form-item",{attrs:{prop:"cover_picture",label:t.$t("post.postCoverPicture")}},[s("el-image",{staticClass:"cover-picture-selected",attrs:{src:this.postForm.cover_picture,fit:"fit"},on:{click:function(e){t.coverPictureDrawer=!0}}},[s("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[t._v("\n                      loading"),s("span",{staticClass:"dot"},[t._v("...")])]),t._v(" "),""!=this.postForm.cover_picture?s("div",{staticClass:"image-error",attrs:{slot:"error"},on:{click:function(e){t.coverPictureDrawer=!0}},slot:"error"},[s("i",{staticClass:"el-icon-picture-outline"})]):s("div",{staticClass:"image-error",attrs:{slot:"error"},on:{click:function(e){t.coverPictureDrawer=!0}},slot:"error"},[s("i",{staticClass:"el-icon-plus"})])])],1)],1),t._v(" "),s("el-col",{staticClass:"post-action-container",attrs:{xs:24,sm:24,md:6,lg:5,xl:5}},[s("el-card",{staticClass:"post-card",attrs:{shadow:"never","body-style":"padding:0"}},[s("div",{staticClass:"post-card-header clearfix"},[s("span",[s("svg-icon",{attrs:{"icon-class":"guide"}}),t._v(" "+t._s(t.$t("post.postPublish")))],1)]),t._v(" "),s("div",{staticClass:"post-card-text"},[s("el-form-item",[s("div",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-star-on"}),t._v(" "+t._s(t.$t("post.postStatus")))]),t._v(" "),"draft"==t.defaultStatus?s("span",[t._v(t._s(t.$t("post.draft")))]):t._e(),t._v(" "),"publish"==t.defaultStatus?s("span",[t._v(t._s(t.$t("post.publish")))]):t._e()]),t._v(" "),s("el-form-item",{attrs:{prop:"comment_status"}},[s("div",{attrs:{slot:"label"},slot:"label"},[s("svg-icon",{attrs:{"icon-class":"comments"}}),t._v(" "+t._s(t.$t("post.postOpenComment")))],1),t._v(" "),s("el-switch",{attrs:{"active-value":t.activeValue,"inactive-value":t.inactiveValue},model:{value:t.postForm.comment_status,callback:function(e){t.$set(t.postForm,"comment_status",e)},expression:"postForm.comment_status"}})],1),t._v(" "),s("el-form-item",{attrs:{prop:"if_top"}},[s("div",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-caret-top"}),t._v(" "+t._s(t.$t("post.postIfTop")))]),t._v(" "),s("el-switch",{attrs:{"active-value":t.activeValue,"inactive-value":t.inactiveValue},model:{value:t.postForm.if_top,callback:function(e){t.$set(t.postForm,"if_top",e)},expression:"postForm.if_top"}})],1),t._v(" "),s("el-form-item",{attrs:{prop:"posted_time"}},[s("div",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-date"}),t._v(" "+t._s(t.$t("post.postPushlishedDate")))]),t._v(" "),s("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:t.$t("post.chooseReleaseTime"),size:"small"},model:{value:t.postForm.posted_time,callback:function(e){t.$set(t.postForm,"posted_time",e)},expression:"postForm.posted_time"}})],1)],1),t._v(" "),s("div",{staticClass:"post-card-bottom clearfix"},["draft"===t.postForm.status?s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.submitForm}},[t._v(t._s(t.$t("post.postPublish")))]):s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.submitForm}},[t._v(t._s(t.$t("post.postSubmitUpdate")))]),t._v(" "),"draft"===t.postForm.status?s("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.draftForm}},[t._v(t._s(t.$t("post.postSaveDraft")))]):s("el-button",{attrs:{type:"info",size:"mini"},on:{click:t.draftForm}},[t._v(t._s(t.$t("post.postSaveAsDraft")))])],1)]),t._v(" "),s("el-card",{staticClass:"post-card",attrs:{shadow:"never","body-style":"padding:0"}},[s("div",{staticClass:"post-card-header clearfix"},[s("span",[s("svg-icon",{attrs:{"icon-class":"list"}}),t._v(" "+t._s(t.$t("post.articleCategory")))],1)]),t._v(" "),s("div",{staticClass:"post-card-text"},[s("el-tabs",{attrs:{type:"card"},model:{value:t.categoryTab,callback:function(e){t.categoryTab=e},expression:"categoryTab"}},[s("el-tab-pane",{staticClass:"post-category-tree",attrs:{label:t.$t("post.articleAllCategory"),name:"allCategory"}},[s("el-input",{staticClass:"category-tree-input",attrs:{placeholder:t.$t("post.inputKeywordsToFilter"),"prefix-icon":"el-icon-search",size:"small",clearable:""},model:{value:t.filterText,callback:function(e){t.filterText=e},expression:"filterText"}}),t._v(" "),s("el-tree",{ref:"categoryTree",attrs:{data:t.categoryData,"show-checkbox":"","check-strictly":"","node-key":"term_id","default-expand-all":t.defaultExpandAllCategory,"default-checked-keys":t.defaultCheckedCategory,"filter-node-method":t.filterNode,props:t.categoryProps},model:{value:t.postForm.category,callback:function(e){t.$set(t.postForm,"category",e)},expression:"postForm.category"}})],1)],1)],1)]),t._v(" "),s("el-card",{staticClass:"post-card",attrs:{shadow:"never","body-style":"padding:0"}},[s("div",{staticClass:"post-card-header clearfix"},[s("span",[s("svg-icon",{attrs:{"icon-class":"tag"}}),t._v(" "+t._s(t.$t("post.articleTag")))],1)]),t._v(" "),s("div",{staticClass:"post-card-text"},[s("el-select",{ref:"tagTree",staticStyle:{width:"100%"},attrs:{filterable:"",multiple:"",placeholder:t.$t("post.pleaseChooseTags")},model:{value:t.postForm.tag,callback:function(e){t.$set(t.postForm,"tag",e)},expression:"postForm.tag"}},t._l(t.tagOptions,function(t){return s("el-option",{key:t.term_id,attrs:{label:t.name,value:t.term_id}})}),1)],1)]),t._v(" "),s("el-card",{staticClass:"post-card",attrs:{shadow:"never","body-style":"padding:0"}},[s("div",{staticClass:"post-card-header clearfix"},[s("span",[s("svg-icon",{attrs:{"icon-class":"component"}}),t._v(" "+t._s(t.$t("post.articleSubject")))],1)]),t._v(" "),s("div",{staticClass:"post-card-text"},[s("div",{staticClass:"post-subject-tree"},[s("el-input",{staticClass:"subject-tree-input",attrs:{placeholder:t.$t("post.inputKeywordsToFilter"),"prefix-icon":"el-icon-search",size:"small",clearable:""},model:{value:t.filterSubjectText,callback:function(e){t.filterSubjectText=e},expression:"filterSubjectText"}}),t._v(" "),s("el-tree",{ref:"subjectTree",attrs:{data:t.subjectData,"show-checkbox":"","node-key":"id","check-strictly":"","default-expand-all":t.defaultExpandAllSubject,"default-checked-keys":t.defaultCheckedSubject,"filter-node-method":t.filterNode,props:t.subjectProps},on:{"check-change":t.subjectCheckChange},model:{value:t.postForm.subject,callback:function(e){t.$set(t.postForm,"subject",e)},expression:"postForm.subject"}})],1)])])],1)],1)],1)]),t._v(" "),s("el-drawer",{ref:"coverPictureDrawer",attrs:{title:"选择封面图",visible:t.coverPictureDrawer,direction:t.coverPictureDirection,size:"50%"},on:{"update:visible":function(e){t.coverPictureDrawer=e},opened:t.getCoverPicture,closed:t.cleanPictureList}},[s("el-row",{directives:[{name:"loading",rawName:"v-loading.body",value:t.coverPictureListLoading,expression:"coverPictureListLoading",modifiers:{body:!0}}],attrs:{gutter:15}},[t._l(t.coverPictureList,function(e){return s("el-col",{key:e.id,staticClass:"picture-list-card",attrs:{xs:24,sm:12,md:6,xl:4}},[s("el-tooltip",{attrs:{effect:"dark",content:e.title,placement:"left-start"}},["picture"===e.type?s("el-image",{staticClass:"picture-list-image",attrs:{src:e.url,fit:"fit",lazy:""},on:{click:function(s){return t.chooseCoverPicture(e.url)}}}):t._e()],1)],1)}),t._v(" "),s("el-col",{attrs:{span:24}},[s("el-pagination",{attrs:{background:"",small:"","current-page":t.coverPictureListQuery.page,"page-size":t.coverPictureListQuery.limit,layout:"total, prev, pager, next",total:t.coverPictureListTotal},on:{"current-change":t.handlePageChange,"update:currentPage":function(e){return t.$set(t.coverPictureListQuery,"page",e)},"update:current-page":function(e){return t.$set(t.coverPictureListQuery,"page",e)}}})],1)],2)],1)],1)])},staticRenderFns:[]};var m=s("VU/8")(d,u,!1,function(t){s("3GKm"),s("8YMv")},"data-v-4501bd42",null);e.a=m.exports}});