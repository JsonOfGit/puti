webpackJsonp([3],{"7eIS":function(e,t,n){(e.exports=n("FZ+f")(!1)).push([e.i,"\n@keyframes treeTableShow {\nfrom {\n    opacity: 0;\n}\nto {\n    opacity: 1;\n}\n}\n@-webkit-keyframes treeTableShow {\nfrom {\n    opacity: 0;\n}\nto {\n    opacity: 1;\n}\n}\n.tree-ctrl {\n  position: relative;\n  cursor: pointer;\n  color: #2196f3;\n}\n",""])},EwUb:function(e,t,n){(e.exports=n("FZ+f")(!1)).push([e.i,"\n.new-category-form{\r\n    border: 1px solid #EBEEF5;\r\n    padding: 0 10px 0 10px;\n}\r\n",""])},ZbqW:function(e,t,n){var a=n("7eIS");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n("rjj0")("356105e9",a,!0)},buca:function(e,t,n){var a=n("EwUb");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n("rjj0")("254b6190",a,!0)},"hX/2":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("h3d2"),o={name:"category",components:{treeTable:n("s3ol").a},data:function(){return{columns:[{label:this.$t("taxonomy.category"),key:"name",expand:!0,width:200,align:"left"},{label:this.$t("taxonomy.taxonomySlug"),key:"slug",width:200,align:"left"},{label:this.$t("taxonomy.taxonomyDesc"),key:"description",align:"left"},{label:this.$t("taxonomy.articleNumber"),key:"count",width:100,align:"center"},{label:this.$t("common.action"),key:"action",width:150,align:"center"}],data:[],dataWithoutDefault:[],listLoading:!0,newForm:{name:"",slug:"",description:"",parentId:0},newProps:{label:"name",value:"term_id"},dialogFormVisible:!1,defaultParentId:[],updateForm:{id:void 0,name:"",slug:"",description:"",parentId:0},updateParentId:[],updateDisabled:!1}},created:function(){this.setTitle(),this.getList()},methods:{setTitle:function(){document.title=this.$t("route."+this.$route.meta.title)+" | Puti"},getList:function(){var e=this;this.listLoading=!0,a.c({type:"category"}).then(function(t){e.data=t.data,e.dataWithoutDefault=e.getDataWithoutDefault(t.data),e.listLoading=!1})},getDataWithoutDefault:function(e){for(var t=[],n=0;n<e.length;n++)1===e[n].term_id&&"uncategorized"===e[n].slug||t.push(e[n]);return t},handleDetail:function(e){var t=this;a.d(e.term_id).then(function(e){t.dialogFormVisible=!0,t.updateForm.id=e.data.term_id,t.updateForm.name=e.data.name,t.updateForm.slug=e.data.slug,t.updateForm.description=e.data.description,t.updateForm.parentId=e.data.parent_term_id,t.updateParentId=t.getParentArr(e.data)}),e.children.length>0&&(this.updateDisabled=!0)},getParentArr:function(e){var t=[];if(0!==e.parent_term_id){var n=this.getParent(this.data,e.parent_term_id,[]);t.push(n[0]),t=this.handleParent(n,n[0],t)}return t},handleParent:function(e,t,n){for(var a=0;a<=e.length-1;a++)if(void 0!==e[a]&&a===t){n.push(e[a]),n=this.handleParent(e,e[a],n);break}return n},getParent:function(e,t,n){var a=this.getUpdateParentId(e,t,[]);return n[a.pid]=a.id,0!==a.pid&&(n=this.getParent(e,a.pid,n)),n},getUpdateParentId:function(e,t,n){for(var a=0;a<=e.length-1;a++){if(t===e[a].term_id){n.id=e[a].term_id,n.pid=e[a].pid,0!==e[a].pid&&(n=this.getUpdateParentId(e,e[a].pid,n));break}null!==e[a].children&&(n=this.getUpdateParentId(e[a].children,t,n))}return n},handleChange:function(e){e.length>0?this.newForm.parentId=e[e.length-1]:this.newForm.parentId=0},handleChangeUpdate:function(e){if(e.length>0){var t=e[e.length-1];this.updateForm.id===t&&(this.updateParentId=[],this.$message.error(this.$t("taxonomy.parentCannotBeSelf"))),this.updateForm.parentId=t}else this.updateForm.parentId=0},closeUpdateDialog:function(){this.updateDisabled=!1},clearNewForm:function(){this.newForm.name="",this.newForm.slug="",this.newForm.description="",this.newForm.parentId=0,this.defaultParentId=[]},createCategory:function(){var e=this;this.newForm.taxonomy="category",a.a(this.newForm).then(function(t){e.$message({message:e.$t("common.operationSucceeded"),type:"success",duration:2e3}),e.getList()})},updateCategory:function(){var e=this;this.dialogFormVisible=!1,this.updateForm.taxonomy="category",a.e(this.updateForm.id,this.updateForm).then(function(t){e.$message({message:e.$t("common.operationSucceeded"),type:"success",duration:2e3}),e.getList()})},handleDelete:function(e){var t=this;this.$confirm(this.$t("taxonomy.confirmToDeleteCategory"),this.$t("common.tips"),{confirmButtonText:this.$t("common.confirm"),cancelButtonText:this.$t("common.cancel"),type:"warning",center:!0}).then(function(){a.b(e.id,{taxonomy:"category"}).then(function(e){t.getList(),t.$message({type:"success",message:t.$t("common.deleteSucceeded")})})}).catch(function(){t.$message({type:"info",message:t.$t("common.cancelDelete")})})}}},r={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("el-row",{attrs:{gutter:30}},[n("el-col",{attrs:{xs:24,sm:24,md:8,lg:8,xl:8}},[n("el-form",{ref:"newForm",staticClass:"new-category-form",attrs:{model:e.newForm,"label-width":"80px","label-position":"top"}},[n("h4",[e._v(e._s(e.$t("taxonomy.newCategory")))]),e._v(" "),n("el-form-item",{attrs:{label:e.$t("taxonomy.taxonomyName")}},[n("el-input",{model:{value:e.newForm.name,callback:function(t){e.$set(e.newForm,"name",t)},expression:"newForm.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("taxonomy.taxonomySlug")}},[n("el-input",{model:{value:e.newForm.slug,callback:function(t){e.$set(e.newForm,"slug",t)},expression:"newForm.slug"}})],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("taxonomy.categoryParent")}},[n("el-cascader",{attrs:{placeholder:e.$t("taxonomy.categoryNoParents"),options:e.dataWithoutDefault,props:e.newProps,"change-on-select":"",clearable:""},on:{change:e.handleChange},model:{value:e.defaultParentId,callback:function(t){e.defaultParentId=t},expression:"defaultParentId"}})],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("taxonomy.taxonomyDesc")}},[n("el-input",{attrs:{type:"textarea"},model:{value:e.newForm.description,callback:function(t){e.$set(e.newForm,"description",t)},expression:"newForm.description"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.createCategory()}}},[e._v(e._s(e.$t("common.addNow")))]),e._v(" "),n("el-button",{attrs:{size:"small",plain:""},on:{click:function(t){e.clearNewForm()}}},[e._v(e._s(e.$t("common.clear")))])],1)],1)],1),e._v(" "),n("el-col",{attrs:{xs:24,sm:24,md:16,lg:16,xl:16}},[n("tree-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.data,columns:e.columns,defaultExpandAll:"","max-height":"800",border:""},scopedSlots:e._u([{key:"action",fn:function(t){var a=t.scope;return[1!=a.row.id?n("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini",circle:""},on:{click:function(t){e.handleDetail(a.row)}}}):e._e(),e._v(" "),null==a.row.children&&1!=a.row.id?n("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini",circle:""},on:{click:function(t){e.handleDelete(a.row)}}}):e._e()]}}])})],1)],1),e._v(" "),n("el-dialog",{attrs:{title:e.$t("taxonomy.categoryDetail"),visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[n("el-form",{attrs:{model:e.updateForm}},[n("el-form-item",{attrs:{label:e.$t("taxonomy.taxonomyName")}},[n("el-input",{attrs:{"auto-complete":"off"},model:{value:e.updateForm.name,callback:function(t){e.$set(e.updateForm,"name",t)},expression:"updateForm.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("taxonomy.taxonomySlug")}},[n("el-input",{attrs:{"auto-complete":"off"},model:{value:e.updateForm.slug,callback:function(t){e.$set(e.updateForm,"slug",t)},expression:"updateForm.slug"}})],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("taxonomy.categoryParent")}},[n("el-cascader",{attrs:{placeholder:e.$t("taxonomy.categoryNoParents"),options:e.dataWithoutDefault,props:e.newProps,"change-on-select":"",clearable:""},on:{change:e.handleChangeUpdate},model:{value:e.updateParentId,callback:function(t){e.updateParentId=t},expression:"updateParentId"}})],1),e._v(" "),n("el-form-item",{attrs:{label:e.$t("taxonomy.taxonomyDesc")}},[n("el-input",{attrs:{type:"textarea"},model:{value:e.updateForm.description,callback:function(t){e.$set(e.updateForm,"description",t)},expression:"updateForm.description"}})],1)],1),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v(e._s(e.$t("common.cancel")))]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.updateCategory()}}},[e._v(e._s(e.$t("common.confirm")))])],1)],1)],1)},staticRenderFns:[]};var i=n("VU/8")(o,r,!1,function(e){n("buca")},null,null);t.default=i.exports},s3ol:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("/5sW");function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.parent,r=void 0===n?null:n,i=t.preIndex,l=void 0!==i&&i,s=t.level,d=void 0===s?0:s,c=t.expand,u=void 0!==c&&c,m=t.children,p=void 0===m?"children":m,h=t.show,f=void 0===h||h,g=t.select,v=void 0!==g&&g;e.forEach(function(e,t){var n=(l?l+"-"+t:t)+"";a.default.set(e,"_id",n),a.default.set(e,"_level",d),a.default.set(e,"_expand",u),a.default.set(e,"_parent",r),a.default.set(e,"_show",f),a.default.set(e,"_select",v),e[p]&&e[p].length>0&&o(e[p],{parent:e,level:d+1,expand:u,preIndex:n,children:p,status:status,select:v})})}var r=n("//Fk"),i=n.n(r),l={name:"TreeTable",props:{data:{type:Array,required:!0,default:function(){return[]}},columns:{type:Array,default:function(){return[]}},defaultExpandAll:{type:Boolean,default:!1},defaultChildren:{type:String,default:"children"},indent:{type:Number,default:50}},data:function(){return{guard:1}},computed:{children:function(){return this.defaultChildren},tableData:function(){var e=this.data;return 0===this.data.length?[]:(o(e,{expand:this.defaultExpandAll,children:this.defaultChildren}),function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"children",o=[];return t.forEach(function(t,r){if(a.default.set(t,"_index",r),o.push(t),t[n]&&t[n].length>0){var i=e(t[n],n);o=o.concat(i)}}),o}(e,this.defaultChildren))}},methods:{addBrother:function(e,t){e._parent?e._parent.children.push(t):this.data.push(t)},addChild:function(e,t){e.children||this.$set(e,"children",[]),e.children.push(t)},delete:function(e){var t=e._index,n=e._parent;n?n.children.splice(t,1):this.data.splice(t,1)},getData:function(){return this.tableData},showRow:function(e){var t=e.row,n=t._parent,a=!n||n._expand&&n._show;return t._show=a,a?"animation:treeTableShow 1s;-webkit-animation:treeTableShow 1s;":"display:none;"},showSperadIcon:function(e){return e[this.children]&&e[this.children].length>0},toggleExpanded:function(e){var t=this.tableData[e],n=!t._expand;t._expand=n},handleCheckAllChange:function(e){this.selcetRecursion(e,e._select,this.defaultChildren),this.isIndeterminate=e._select},selcetRecursion:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"children";t&&(this.$set(e,"_expand",!0),this.$set(e,"_show",!0));var o=e[a];o&&o.length>0&&o.map(function(e){e._select=t,n.selcetRecursion(e,t,a)})},updateTreeNode:function(e){var t=this;return new i.a(function(n){var a=e._id,o=e._parent,r=a.split("-").slice(-1)[0];o?(o.children.splice(r,1,e),n(t.data)):(t.data.splice(r,1,e),n(t.data))})}}},s={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-table",e._g(e._b({attrs:{data:e.tableData,"row-style":e.showRow}},"el-table",e.$attrs,!1),e.$listeners),[e._t("selection"),e._v(" "),e._t("pre-column"),e._v(" "),e._l(e.columns,function(t){return n("el-table-column",{key:t.key,attrs:{label:t.label,width:t.width,align:t.align||"center","header-align":t.headerAlign},scopedSlots:e._u([{key:"default",fn:function(a){return[e._t(t.key,[t.expand?[n("span",{style:{"padding-left":+a.row._level*e.indent+"px"}}),e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:e.showSperadIcon(a.row),expression:"showSperadIcon(scope.row)"}],staticClass:"tree-ctrl",on:{click:function(t){e.toggleExpanded(a.$index)}}},[a.row._expand?n("i",{staticClass:"el-icon-minus"}):n("i",{staticClass:"el-icon-plus"})])]:e._e(),e._v(" "),t.checkbox?[a.row[e.defaultChildren]&&a.row[e.defaultChildren].length>0?n("el-checkbox",{style:{"padding-left":+a.row._level*e.indent+"px"},attrs:{indeterminate:a.row._select},on:{change:function(t){e.handleCheckAllChange(a.row)}},model:{value:a.row._select,callback:function(t){e.$set(a.row,"_select",t)},expression:"scope.row._select"}}):n("el-checkbox",{style:{"padding-left":+a.row._level*e.indent+"px"},on:{change:function(t){e.handleCheckAllChange(a.row)}},model:{value:a.row._select,callback:function(t){e.$set(a.row,"_select",t)},expression:"scope.row._select"}})]:e._e(),e._v("\n        "+e._s(a.row[t.key])+"\n      ")],{scope:a})]}}])})})],2)},staticRenderFns:[]};var d=n("VU/8")(l,s,!1,function(e){n("ZbqW")},null,null);t.a=d.exports}});