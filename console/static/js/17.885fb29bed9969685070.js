webpackJsonp([17],{Ep14:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("0QkR"),i=s("M9A7"),r={name:"subject-new",data:function(){return{form:{name:"",slug:"",parent_id:0,cover_image:0,description:""},parentData:[],parentProps:{label:"name",value:"id"},fileList:[],limitUploadNumber:1,uploadUrl:"/api/media",uploadHeaders:{Authorization:""},uploadParams:{userId:"",usage:"cover"}}},created:function(){this.setTitle(),this.getParentList(),this.handleUploadAuth()},methods:{setTitle:function(){document.title=this.$t("route."+this.$route.meta.title)+" | Puti"},getParentList:function(){var t=this;Object(a.c)().then(function(e){t.parentData=e.data})},handleChangeParent:function(t){t.length>0?this.form.parent_id=t[t.length-1]:this.form.parent_id=0},handleUploadAuth:function(){var t=this,e=this.$store.getters.token;this.uploadHeaders.Authorization="Bearer "+e,Object(i.a)(e).then(function(e){t.uploadParams.userId=e.data.id})},submitSubject:function(){this.$refs.upload.uploadFiles[0]?this.$refs.upload.submit():this.createSubject()},resetInput:function(){},handleRemove:function(t,e){this.$notify.info({title:this.$t("subject.cancelImage"),message:this.$t("subject.uploadAgainTips"),duration:3e3})},uploadSuccess:function(t,e,s){0===t.code&&(this.$notify.info({title:this.$t("subject.uploadCoverSuccess"),message:this.$t("subject.creatingSubjectNow"),duration:2e3}),this.form.cover_image=t.data.id,this.createSubject())},createSubject:function(){var t=this;Object(a.a)(this.form).then(function(e){t.$notify.success({title:t.$t("common.operationSucceeded"),message:t.$t("subject.createSubjectSuccess"),duration:3e3}),t.$router.push({path:"/subject/manage"})})}}},o={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app-container"},[s("el-card",{staticClass:"box-card setting-form",attrs:{shadow:"hover"}},[s("div",{staticClass:"setting-form-header clearfix",attrs:{slot:"header"},slot:"header"},[s("span",{staticClass:"setting-header-title"},[t._v(t._s(t.$t("subject.newSubject")))]),t._v(" "),s("span",{staticClass:"setting-header-subtitle"},[t._v(t._s(t.$t("subject.newSubjectDesc")))])]),t._v(" "),s("el-form",{ref:"form",attrs:{model:t.form,"label-width":"150px"}},[s("div",{staticClass:"setting-form-body"},[s("el-row",[s("el-col",{attrs:{span:14,offset:2}},[s("el-form-item",{attrs:{label:t.$t("subject.subjectName")}},[s("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}}),t._v(" "),s("p",{staticClass:"setting-form-desc"},[t._v(t._s(t.$t("subject.subjectNameDesc")))])],1),t._v(" "),s("el-form-item",{attrs:{label:t.$t("subject.subjectSlug")}},[s("el-input",{model:{value:t.form.slug,callback:function(e){t.$set(t.form,"slug",e)},expression:"form.slug"}}),t._v(" "),s("p",{staticClass:"setting-form-desc"},[t._v(t._s(t.$t("subject.subjectSlugDesc")))])],1),t._v(" "),s("el-form-item",{attrs:{label:t.$t("subject.parentSubject")}},[s("el-cascader",{attrs:{placeholder:t.$t("subject.parentSubjectPlaceholder"),options:t.parentData,props:t.parentProps,"change-on-select":"",clearable:""},on:{change:t.handleChangeParent}}),t._v(" "),s("p",{staticClass:"setting-form-desc"},[t._v(t._s(t.$t("subject.parentSubjectDesc")))])],1),t._v(" "),s("el-form-item",{attrs:{label:t.$t("subject.subjectCoverPicture")}},[s("el-upload",{ref:"upload",attrs:{action:t.uploadUrl,headers:t.uploadHeaders,data:t.uploadParams,"auto-upload":!1,limit:t.limitUploadNumber,"on-success":t.uploadSuccess,"on-remove":t.handleRemove,"file-list":t.fileList,"list-type":"picture"}},[s("el-button",{attrs:{slot:"trigger",size:"mini",type:"primary"},slot:"trigger"},[t._v("选择图片")]),t._v(" "),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件")])],1),t._v(" "),s("p",{staticClass:"setting-form-desc"},[t._v(t._s(t.$t("subject.subjectCoverPictureDesc")))])],1),t._v(" "),s("el-form-item",{attrs:{label:t.$t("subject.subjectDescription"),prop:"description"}},[s("el-input",{attrs:{type:"textarea",rows:"5"},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}}),t._v(" "),s("p",{staticClass:"setting-form-desc"},[t._v(t._s(t.$t("subject.subjectDescriptionDesc")))])],1)],1)],1),t._v(" "),s("el-row",{staticClass:"setting-form-footer"},[s("el-col",{attrs:{span:14,offset:4}},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.submitSubject}},[t._v(t._s(t.$t("common.confirm")))]),t._v(" "),s("el-button",{attrs:{size:"small"},on:{click:t.resetInput}},[t._v(t._s(t.$t("common.reset")))])],1)],1)],1)])],1)],1)},staticRenderFns:[]},c=s("VU/8")(r,o,!1,null,null,null);e.default=c.exports}});